@echo off
REM ================================================================
REM omnic-v2.run - Self-Extracting Omni Package
REM Generated by Omni Compiler
REM ================================================================

where node >nul 2>nul
if %ERRORLEVEL% neq 0 (
    echo [omni] Node.js is required but not installed.
    echo [omni] Install: https://nodejs.org/
    exit /b 1
)

echo [omni] Starting omnic-v2...
powershell -Command "[System.Text.Encoding]::UTF8.GetString([Convert]::FromBase64String('Ly8gPT09IGNsaWVudC5qcyA9PT0KY29uc3QgbW9kZWxzID0gcmVxdWlyZSgiLi9zaGFyZWQvbW9kZWxzLmpzIik7CmlmICh0eXBlb2YgZ2xvYmFsICE9PSAndW5kZWZpbmVkJykgT2JqZWN0LmFzc2lnbihnbG9iYWwsIG1vZGVscyk7CmZ1bmN0aW9uIGRpc3BsYXlfdXNlcih1c2VyKSB7CiAgICBwcmludCgiVXNlcjogIiArIHVzZXIubmFtZSArICIgKCIgKyB1c2VyLmVtYWlsICsgIikiKTsKfQpmdW5jdGlvbiBtYWluKCkgewogICAgcHJpbnQoIkNsaWVudCBzdGFydGluZy4uLiIpOwogICAgbGV0IHVzZXIgPSBjcmVhdGVfdXNlcig0MiwgIkFsaWNlIiwgImFsaWNlQGV4YW1wbGUuY29tIik7CiAgICBkaXNwbGF5X3VzZXIodXNlcik7Cn0KCgovLyA9PT0gbW9kZWxzLmpzID09PQpjbGFzcyBVc2VyIHsKICAgIGNvbnN0cnVjdG9yKGRhdGEgPSB7fSkgewogICAgICAgIHRoaXMuaWQgPSBkYXRhLmlkOwogICAgICAgIHRoaXMubmFtZSA9IGRhdGEubmFtZTsKICAgICAgICB0aGlzLmVtYWlsID0gZGF0YS5lbWFpbDsKICAgIH0KfQoKY2xhc3MgTWVzc2FnZSB7CiAgICBjb25zdHJ1Y3RvcihkYXRhID0ge30pIHsKICAgICAgICB0aGlzLmlkID0gZGF0YS5pZDsKICAgICAgICB0aGlzLnVzZXJfaWQgPSBkYXRhLnVzZXJfaWQ7CiAgICAgICAgdGhpcy5jb250ZW50ID0gZGF0YS5jb250ZW50OwogICAgfQp9CgpmdW5jdGlvbiBjcmVhdGVfdXNlcihpZCwgbmFtZSwgZW1haWwpIHsKICAgIHJldHVybiBuZXcgVXNlcih7IGlkOiBpZCwgbmFtZTogbmFtZSwgZW1haWw6IGVtYWlsIH0pOwp9Cgptb2R1bGUuZXhwb3J0cyA9IHsgVXNlciwgTWVzc2FnZSwgY3JlYXRlX3VzZXIgfTsKCgo='))" > %TEMP%\omni_app.js
node %TEMP%\omni_app.js %*
del %TEMP%\omni_app.js
